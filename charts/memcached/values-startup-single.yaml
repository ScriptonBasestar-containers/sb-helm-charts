# Startup scenario for memcached
# Balanced configuration for small team/startup use
# Single replica with monitoring enabled

# 1. Application-specific Configuration

memcached:
  # Moderate memory for team use (256MB)
  maxMemory: 256

  # Moderate connection limit
  maxConnections: 512

  chunkSizeGrowthFactor: 1.25
  minItemSize: 48
  enableCas: true
  verbosity: 0
  extraArgs: []

# 4. Kubernetes Resources

replicaCount: 1

image:
  repository: memcached
  pullPolicy: IfNotPresent
  tag: "1.6.39-alpine3.22"

strategy:
  type: RollingUpdate
  rollingUpdate:
    maxUnavailable: 0
    maxSurge: 1

# 5. Service Account

serviceAccount:
  create: true
  automount: true

# 6. Pod Configuration

podSecurityContext:
  fsGroup: 11211
  runAsUser: 11211
  runAsGroup: 11211
  runAsNonRoot: true

securityContext:
  capabilities:
    drop:
      - ALL
  readOnlyRootFilesystem: true
  runAsNonRoot: true
  runAsUser: 11211
  runAsGroup: 11211
  allowPrivilegeEscalation: false

# 7. Service Configuration

service:
  type: ClusterIP
  port: 11211

# 9. Resources - Balanced for startup

resources:
  limits:
    cpu: 500m
    memory: 512Mi
  requests:
    cpu: 100m
    memory: 128Mi

# 10. Health Probes

livenessProbe:
  enabled: true
  tcpSocket:
    port: 11211
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 6
  successThreshold: 1

readinessProbe:
  enabled: true
  tcpSocket:
    port: 11211
  initialDelaySeconds: 5
  periodSeconds: 10
  timeoutSeconds: 3
  failureThreshold: 3
  successThreshold: 1

startupProbe:
  enabled: true
  tcpSocket:
    port: memcached
  initialDelaySeconds: 5
  periodSeconds: 5
  timeoutSeconds: 3
  failureThreshold: 10
  successThreshold: 1

# 11. Autoscaling - Disabled (manual scaling)

autoscaling:
  enabled: false

# 12. Pod Disruption Budget - Optional

podDisruptionBudget:
  enabled: false

# 13. Network Policy - Optional

networkPolicy:
  enabled: false

# 14. Monitoring - Enabled with metrics exporter

monitoring:
  enabled: true

metrics:
  enabled: true
  image:
    repository: prom/memcached-exporter
    tag: v0.14.4
    pullPolicy: IfNotPresent
  resources:
    limits:
      cpu: 100m
      memory: 128Mi
    requests:
      cpu: 50m
      memory: 64Mi
  port: 9150

# 15. Scheduling

nodeSelector: {}
tolerations: []
affinity: {}
