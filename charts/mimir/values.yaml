# Default values for mimir.

# RBAC Configuration
rbac:
  # Create RBAC resources (Role, RoleBinding)
  create: true
  # Annotations to add to the RBAC resources
  annotations: {}

# Number of Mimir instances (monolithic mode)
replicaCount: 1

image:
  repository: grafana/mimir
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion
  tag: ""

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

# Mimir configuration
mimir:
  # Use an existing ConfigMap for Mimir configuration
  existingConfigMap: ""

  # Use an existing Secret for S3/storage credentials
  existingSecret: ""

  # Target mode: all (monolithic), read, write, backend
  target: "all"

  # Multi-tenancy configuration
  multitenancy:
    enabled: false

  # Storage configuration
  storage:
    # Storage backend: filesystem, s3, gcs, azure
    backend: "filesystem"

    # S3 storage configuration
    s3:
      endpoint: ""
      bucket: "mimir-blocks"
      region: "us-east-1"
      accessKeyId: ""
      secretAccessKey: ""
      insecure: false

    # GCS storage configuration
    gcs:
      bucketName: ""
      serviceAccount: ""

    # Azure storage configuration
    azure:
      accountName: ""
      accountKey: ""
      containerName: ""

  # Block storage settings
  blocks:
    # Retention period for blocks
    retentionPeriod: "2w"

  # Compactor settings
  compactor:
    # Data directory for compactor
    dataDir: "/data/compactor"

  # Ingester settings
  ingester:
    # Data directory for ingester WAL
    walDir: "/data/ingester"
    # Ring configuration
    ring:
      replicationFactor: 1

  # Store-gateway settings
  storeGateway:
    # Data directory
    dataDir: "/data/store-gateway"

  # Ruler settings
  ruler:
    # Enable ruler for alerting rules
    enabled: false
    # Data directory
    dataDir: "/data/ruler"
    # Alertmanager URL
    alertmanagerUrl: ""

  # Query frontend settings
  queryFrontend:
    # Max outstanding requests per tenant
    maxOutstandingPerTenant: 100

  # Limits configuration
  limits:
    # Ingestion rate limit (samples/second)
    ingestionRate: 10000
    # Ingestion burst size
    ingestionBurstSize: 200000
    # Max global series per user
    maxGlobalSeriesPerUser: 150000
    # Max label names per series
    maxLabelNamesPerSeries: 30
    # Max label name length
    maxLabelNameLength: 1024
    # Max label value length
    maxLabelValueLength: 2048
    # Max query length
    maxQueryLength: "768h"

  # Server configuration
  server:
    httpListenPort: 8080
    grpcListenPort: 9095

  # Additional Mimir configuration (merged into config)
  config: {}

  # Extra environment variables
  extraEnv: []
  # - name: CUSTOM_VAR
  #   value: "custom_value"

serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use
  name: ""

podAnnotations: {}

podSecurityContext:
  fsGroup: 10001
  runAsUser: 10001
  runAsNonRoot: true

securityContext:
  capabilities:
    drop:
    - ALL
  readOnlyRootFilesystem: true
  runAsNonRoot: true
  runAsUser: 10001

service:
  type: ClusterIP
  httpPort: 8080
  grpcPort: 9095
  annotations: {}

# ServiceMonitor for Prometheus Operator
serviceMonitor:
  enabled: false
  namespace: ""
  interval: "30s"
  scrapeTimeout: "10s"
  labels: {}

resources:
  limits:
    cpu: 2000m
    memory: 4Gi
  requests:
    cpu: 500m
    memory: 1Gi

livenessProbe:
  initialDelaySeconds: 45
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3

readinessProbe:
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3

# Persistence configuration
persistence:
  enabled: true
  storageClass: ""
  annotations: {}
  accessMode: ReadWriteOnce
  size: 50Gi
  # Existing claim to use
  existingClaim: ""

nodeSelector: {}

tolerations: []

affinity: {}

# Pod Disruption Budget
podDisruptionBudget:
  enabled: false
  minAvailable: 1
  # maxUnavailable: 1

# Horizontal Pod Autoscaler
autoscaling:
  enabled: false
  minReplicas: 2
  maxReplicas: 10
  targetCPUUtilizationPercentage: 80
  targetMemoryUtilizationPercentage: 80
