{{- if and (not .Values.redis.existingConfigMap) .Values.redis.config }}
{{- $usePassword := or .Values.redis.password .Values.redis.existingSecret }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "redis.fullname" . }}
  labels:
    {{- include "redis.labels" . | nindent 4 }}
data:
  redis.conf: |
{{- .Values.redis.config | nindent 4 }}
{{- if not $usePassword }}
    # No password authentication
{{- end }}
{{- end }}
